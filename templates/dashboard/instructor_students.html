{% extends "dashboard/instructor_base.html" %}

{% block instructor_content %}

<h3 class="fw-bold mb-3">ðŸ‘¥ Enrolled Students</h3>
<p class="text-muted">
  Select a course to view enrolled students
</p>

<!-- FILTER -->
<div class="card shadow-sm border-0 mb-4">
  <div class="card-body">

    <form method="get">

      <div class="row align-items-end g-3">

        <div class="col-md-4">
          <label class="form-label fw-semibold">
            Filter by Course
          </label>

          <select name="course"
                  class="form-select"
                  onchange="this.form.submit()">

            <option value="">All Courses</option>

            {% for course in courses %}
              <option value="{{ course.id }}"
                {% if selected_course_id == course.id|stringformat:"s" %}
                  selected
                {% endif %}
              >
                {{ course.title }}
              </option>
            {% endfor %}

          </select>
        </div>

        <div class="col-md-4">
          <div class="text-muted small">
            Showing
            <strong>{{ enrollments.count }}</strong>
            student(s)
            {% if selected_course_id %}
              for selected course
            {% endif %}
          </div>
        </div>

      </div>

    </form>

  </div>
</div>

<!-- STUDENTS TABLE -->
<div class="card shadow-sm border-0">

  <div class="card-header bg-white fw-semibold">
    ðŸ“‹ Students List
  </div>

  <div class="card-body p-0">

    <table class="table align-middle mb-0">
      <thead class="table-light">
        <tr>
          <th>Student</th>
          <th>Email</th>
          <th>Course</th>
          <th>Enrolled On</th>
        </tr>
      </thead>

      <tbody>

        {% for e in enrollments %}
          <tr>
            <td class="fw-semibold">
              {{ e.student.get_full_name|default:e.student.username }}
            </td>

            <td>
              {{ e.student.email }}
            </td>

            <td>
              <span class="badge bg-info text-dark">
                {{ e.course.title }}
              </span>
            </td>

            <td>
              {{ e.enrolled_at|date:"M d, Y" }}
            </td>
          </tr>
        {% empty %}
          <tr>
            <td colspan="4" class="text-muted text-center py-4">
              No students found for this course.
            </td>
          </tr>
        {% endfor %}

      </tbody>
    </table>

  </div>

</div>

{% endblock %}
