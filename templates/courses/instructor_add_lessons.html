{% extends "dashboard/instructor_base.html" %}

{% block instructor_content %}

<h3 class="mb-3">üìö Manage Lessons ‚Äî {{ course.title }}</h3>

<!-- ADD LESSON FORM -->
<div class="card shadow-sm">
  <div class="card-body">

    <h5 class="mb-3">‚ûï Add New Lesson</h5>

    <form method="post" enctype="multipart/form-data">
      {% csrf_token %}

      <div class="mb-3">
        <label class="form-label">Lesson Title</label>
        <input type="text" name="title" class="form-control" required>
      </div>

      <div class="mb-3">
      <label>YouTube URL (optional)</label>
      <input type="url" name="youtube_url" class="form-control">
      </div>

      <div class="mb-3">
          <label>Upload Video File (optional)</label>
          <input type="file" name="video_file" class="form-control">
      </div>


      <div class="mb-3">
        <label class="form-label">PDF Notes</label>
        <input type="file" name="pdf_notes" class="form-control">
      </div>

      <div class="mb-3">
        <label class="form-label">Lesson Order</label>
        <input type="number" name="order" class="form-control" required>
      </div>

      <button class="btn btn-success">
        ‚ûï Add Lesson
      </button>

    </form>

  </div>
</div>

<hr>

<!-- EXISTING LESSONS -->
<h5 class="mt-4">üìù Existing Lessons</h5>

<div class="card shadow-sm">
  <div class="card-body p-0">

    <table class="table table-striped align-middle mb-0">

      <thead class="table-light">
        <tr>
          <th style="width:80px;">Order</th>
          <th>Title</th>
          <th>Video</th>
          <th>Notes</th>
          <th style="width:200px;">Actions</th>
        </tr>
      </thead>

      <tbody>

        {% for lesson in lessons %}
          <tr>

            <td>{{ lesson.order }}</td>

            <td>{{ lesson.title }}</td>

            <td>
              {% if lesson.youtube_url %}
                <a href="{{ lesson.youtube_url }}" target="_blank"
                   class="badge bg-info text-decoration-none">
                  ‚ñ∂ Video
                </a>
              {% else %}
                <span class="badge bg-secondary">
                  No Video
                </span>
              {% endif %}
            </td>

            <td>
              {% if lesson.pdf_notes %}
                <a href="{{ lesson.pdf_notes.url }}" target="_blank"
                   class="badge bg-success text-decoration-none">
                  üìÑ Notes
                </a>
              {% else %}
                <span class="badge bg-secondary">
                  No Notes
                </span>
              {% endif %}
            </td>

            <td>

              <!-- EDIT -->
              <a href="{% url 'instructor_edit_lesson' course.id lesson.id %}"
                 class="btn btn-sm btn-outline-primary">
                ‚úè Edit
              </a>

              <!-- DELETE -->
              <a href="{% url 'instructor_delete_lesson' course.id lesson.id %}"
                 class="btn btn-sm btn-outline-danger"
                 onclick="return confirm('Are you sure you want to delete this lesson?');">
                üóë Delete
              </a>

            </td>

          </tr>
        {% empty %}
          <tr>
            <td colspan="5" class="text-center text-muted">
              No lessons added yet.
            </td>
          </tr>
        {% endfor %}

      </tbody>

    </table>

  </div>
</div>

{% endblock %}
